image: gentoo/stage3-amd64:latest

variables:
  FEATURES: "getbinpkg"
  GIT_SUBMODULE_STRATEGY: recursive
  MAKEOPTS: "--jobs=10"
  PORTAGE_BINHOST: "https://xgqt.gitlab.io/gentoo-mini-mirror/binpkgs"
  USE: "-perl"

stages:
  - test

before_script:
  - mkdir -p /var/cache/distfiles
  - mkdir -p /var/db/repos/gentoo
  - emerge-webrsync
  - emerge -1nq --jobs=10 app-portage/repoman dev-vcs/git net-misc/wget

test:
  stage: test
  script:
    - bash scripts/repomanci
